SELECT ue.candidate_name,('https://app.eightfold.ai/profile/' || ue.profile_id::VARCHAR) AS profile_link,vpr.current_company,ue.position_name,ue.candidate_email,ue.timezone_name,ue.profile_id,ue.position_id,va.match_stars,ue.creator_user_id,ue.created_at AS interview_email_sent_at,DATEDIFF(day,ue.created_at,CURRENT_DATE) AS Days_pending_Invitation,ue.schedule_start_time,ue.status AS interview_status,ue.duration_minutes,ue.meeting_time,pf.reviewer_email,pf.feedback_template_name,pf.status AS feedback_status,pf.feedback_json,vp.location_country,vp.job_function,vp.hiring_manager_name,vp.recruiter_name,CASE WHEN ue.schedule_start_time IS NOT NULL THEN DATEDIFF(day,ue.schedule_start_time,CURRENT_DATE) ELSE NULL END AS time_since_interview_completion_days,CASE WHEN ue.created_at IS NOT NULL AND ue.schedule_start_time IS NOT NULL THEN DATEDIFF(day,ue.created_at,ue.schedule_start_time) ELSE NULL END AS invitation_to_completion_days,CASE WHEN ue.status = 'CONFIRMED' THEN CASE WHEN ue.schedule_start_time > CURRENT_TIMESTAMP THEN 'SCHEDULED' WHEN pf.status = 'SUBMITTED' OR pf.status = 'AI_RECOMMENDED' THEN 'COMPLETED' WHEN pf.status = 'REQUESTED' THEN 'CANDIDATE NO-SHOW' ELSE ue.status END ELSE ue.status END AS "Interview_Status_Real" FROM amgen_user_calendar_events ue LEFT OUTER JOIN amgen_profile_feedback pf ON (ue.id = pf.user_calendar_event_id AND ue.group_id = pf.group_id) LEFT OUTER JOIN amgen_positions vp ON ue.position_id = vp.position_id LEFT OUTER JOIN amgen_profile vpr ON ue.profile_id = vpr.profile_id LEFT OUTER JOIN amgen_applications va ON (ue.profile_id = va.profile_id AND ue.position_id = va.position_id AND ue.group_id = va.group_id) WHERE ue.group_id = 'amgen.com' AND ue.created_at > '2025-04-16' AND ue.interview_slots_json[0].interviewers[0].is_ai_interviewer = TRUE AND ue.position_name != 'AIR Testing' ORDER BY ue.created_at DESC;
